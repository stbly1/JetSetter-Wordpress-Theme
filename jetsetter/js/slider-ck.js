/*
 * Twenty Fourteen Featured Content Slider
 *
 * Adapted from FlexSlider v2.2.0, copyright 2012 WooThemes
 * @link http://www.woothemes.com/flexslider/
 *//* global DocumentTouch:true,setImmediate:true,featuredSliderDefaults:true,MSGesture:true */(function(e){e.featuredslider=function(t,n){var r=e(t),i=window.navigator&&window.navigator.msPointerEnabled&&window.MSGesture,s="ontouchstart"in window||i||window.DocumentTouch&&document instanceof DocumentTouch,o="click touchend MSPointerUp",u="",a,f={},l;r.vars=e.extend({},e.featuredslider.defaults,n);l=r.vars.namespace,e.data(t,"featuredslider",r);f={init:function(){r.animating=!1;r.currentSlide=0;r.animatingTo=r.currentSlide;r.atEnd=r.currentSlide===0||r.currentSlide===r.last;r.containerSelector=r.vars.selector.substr(0,r.vars.selector.search(" "));r.slides=e(r.vars.selector,r);r.container=e(r.containerSelector,r);r.count=r.slides.length;r.prop="marginLeft";r.isRtl=e("body").hasClass("rtl");r.args={};r.transitions=function(){var e=document.createElement("div"),t=["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"],n;for(n in t)if(e.style[t[n]]!==undefined){r.pfx=t[n].replace("Perspective","").toLowerCase();r.prop="-"+r.pfx+"-transform";return!0}return!1}();r.vars.controlsContainer!==""&&(r.controlsContainer=e(r.vars.controlsContainer).length>0&&e(r.vars.controlsContainer));r.doMath();r.setup("init");f.controlNav.setup();f.directionNav.setup();e(r.containerSelector).length===1&&e(document).bind("keyup",function(e){var t=e.keyCode,n=!1;if(!r.animating&&(t===39||t===37)){t===39?n=r.getTarget("next"):t===37&&(n=r.getTarget("prev"));r.featureAnimate(n)}});s&&f.touch();e(window).bind("resize orientationchange focus",f.resize);r.find("img").attr("draggable","false")},controlNav:{setup:function(){f.controlNav.setupPaging()},setupPaging:function(){var t="control-paging",n=1,i,s,a;r.controlNavScaffold=e('<ol class="'+l+"control-nav "+l+t+'"></ol>');if(r.pagingCount>1)for(a=0;a<r.pagingCount;a++){s=r.slides.eq(a);i="<a>"+n+"</a>";r.controlNavScaffold.append("<li>"+i+"</li>");n++}r.controlsContainer?e(r.controlsContainer).append(r.controlNavScaffold):r.append(r.controlNavScaffold);f.controlNav.set();f.controlNav.active();r.controlNavScaffold.delegate("a, img",o,function(t){t.preventDefault();if(u===""||u===t.type){var n=e(this),i=r.controlNav.index(n);if(!n.hasClass(l+"active")){r.direction=i>r.currentSlide?"next":"prev";r.featureAnimate(i)}}u===""&&(u=t.type);f.setToClearWatchedEvent()})},set:function(){var t="a";r.controlNav=e("."+l+"control-nav li "+t,r.controlsContainer?r.controlsContainer:r)},active:function(){r.controlNav.removeClass(l+"active").eq(r.animatingTo).addClass(l+"active")},update:function(t,n){r.pagingCount>1&&t==="add"?r.controlNavScaffold.append(e("<li><a>"+r.count+"</a></li>")):r.pagingCount===1?r.controlNavScaffold.find("li").remove():r.controlNav.eq(n).closest("li").remove();f.controlNav.set();r.pagingCount>1&&r.pagingCount!==r.controlNav.length?r.update(n,t):f.controlNav.active()}},directionNav:{setup:function(){var t=e('<ul class="'+l+'direction-nav"><li><a class="'+l+'prev" href="#">'+r.vars.prevText+'</a></li><li><a class="'+l+'next" href="#">'+r.vars.nextText+"</a></li></ul>");if(r.controlsContainer){e(r.controlsContainer).append(t);r.directionNav=e("."+l+"direction-nav li a",r.controlsContainer)}else{r.append(t);r.directionNav=e("."+l+"direction-nav li a",r)}f.directionNav.update();r.directionNav.bind(o,function(t){t.preventDefault();var n;if(u===""||u===t.type){n=e(this).hasClass(l+"next")?r.getTarget("next"):r.getTarget("prev");r.featureAnimate(n)}u===""&&(u=t.type);f.setToClearWatchedEvent()})},update:function(){var e=l+"disabled";r.pagingCount===1?r.directionNav.addClass(e).attr("tabindex","-1"):r.directionNav.removeClass(e).removeAttr("tabindex")}},touch:function(){function p(i){if(r.animating)i.preventDefault();else if(window.navigator.msPointerEnabled||i.touches.length===1){o=r.w;a=Number(new Date);l=i.touches[0].pageX;c=i.touches[0].pageY;s=(r.currentSlide+r.cloneOffset)*o;r.animatingTo===r.last&&r.direction!=="next"&&(s=0);e=l;n=c;t.addEventListener("touchmove",d,!1);t.addEventListener("touchend",v,!1)}}function d(t){l=t.touches[0].pageX;c=t.touches[0].pageY;u=e-l;f=Math.abs(u)<Math.abs(c-n);if(!f){t.preventDefault();r.transitions&&r.setProps(s+u,"setTouch")}}function v(){t.removeEventListener("touchmove",d,!1);if(r.animatingTo===r.currentSlide&&!f&&u!==null){var i=u,o=i>0?r.getTarget("next"):r.getTarget("prev");r.featureAnimate(o)}t.removeEventListener("touchend",v,!1);e=null;n=null;u=null;s=null}function m(e){e.stopPropagation();if(r.animating)e.preventDefault();else{t._gesture.addPointer(e.pointerId);h=0;o=r.w;a=Number(new Date);s=(r.currentSlide+r.cloneOffset)*o;r.animatingTo===r.last&&r.direction!=="next"&&(s=0)}}function g(e){e.stopPropagation();var n=e.target._slider,r,i;if(!n)return;r=-e.translationX,i=-e.translationY;h+=r;u=h;f=Math.abs(h)<Math.abs(-i);if(e.detail===e.MSGESTURE_FLAG_INERTIA){setImmediate(function(){t._gesture.stop()});return}if(!f||Number(new Date)-a>500){e.preventDefault();n.transitions&&n.setProps(s+u,"setTouch")}}function y(t){t.stopPropagation();var r=t.target._slider,i,o;if(!r)return;if(r.animatingTo===r.currentSlide&&!f&&u!==null){i=u,o=i>0?r.getTarget("next"):r.getTarget("prev");r.featureAnimate(o)}e=null;n=null;u=null;s=null;h=0}var e,n,s,o,u,a,f=!1,l=0,c=0,h=0;if(!i)t.addEventListener("touchstart",p,!1);else{t.style.msTouchAction="none";t._gesture=new MSGesture;t._gesture.target=t;t.addEventListener("MSPointerDown",m,!1);t._slider=r;t.addEventListener("MSGestureChange",g,!1);t.addEventListener("MSGestureEnd",y,!1)}},resize:function(){if(!r.animating&&r.is(":visible")){r.doMath();f.smoothHeight();r.newSlides.width(r.computedW);r.setProps(r.computedW,"setTotal")}},smoothHeight:function(e){var t=r.viewport;e?t.animate({height:r.slides.eq(r.animatingTo).height()},e):t.height(r.slides.eq(r.animatingTo).height())},setToClearWatchedEvent:function(){clearTimeout(a);a=setTimeout(function(){u=""},3e3)}};r.featureAnimate=function(e){e!==r.currentSlide&&(r.direction=e>r.currentSlide?"next":"prev");if(!r.animating&&r.is(":visible")){r.animating=!0;r.animatingTo=e;f.controlNav.active();r.slides.removeClass(l+"active-slide").eq(e).addClass(l+"active-slide");r.atEnd=e===0||e===r.last;f.directionNav.update();var t=r.computedW,n;r.currentSlide===0&&e===r.count-1&&r.direction!=="next"?n=0:r.currentSlide===r.last&&e===0&&r.direction!=="prev"?n=(r.count+1)*t:n=(e+r.cloneOffset)*t;r.setProps(n,"",r.vars.animationSpeed);if(r.transitions){if(!r.atEnd){r.animating=!1;r.currentSlide=r.animatingTo}r.container.unbind("webkitTransitionEnd transitionend");r.container.bind("webkitTransitionEnd transitionend",function(){r.wrapup(t)})}else r.container.animate(r.args,r.vars.animationSpeed,"swing",function(){r.wrapup(t)});f.smoothHeight(r.vars.animationSpeed)}};r.wrapup=function(e){r.currentSlide===0&&r.animatingTo===r.last?r.setProps(e,"jumpEnd"):r.currentSlide===r.last&&r.animatingTo===0&&r.setProps(e,"jumpStart");r.animating=!1;r.currentSlide=r.animatingTo};r.getTarget=function(e){r.direction=e;r.isRtl&&(e="next"===e?"prev":"next");return e==="next"?r.currentSlide===r.last?0:r.currentSlide+1:r.currentSlide===0?r.last:r.currentSlide-1};r.setProps=function(e,t,n){var i=function(){var n=function(){switch(t){case"setTotal":return(r.currentSlide+r.cloneOffset)*e;case"setTouch":return e;case"jumpEnd":return r.count*e;case"jumpStart":return e;default:return e}}();return n*-1+"px"}();if(r.transitions){i="translate3d("+i+",0,0 )";n=n!==undefined?n/1e3+"s":"0s";r.container.css("-"+r.pfx+"-transition-duration",n)}r.args[r.prop]=i;(r.transitions||n===undefined)&&r.container.css(r.args)};r.setup=function(t){var n;if(t==="init"){r.viewport=e('<div class="'+l+'viewport"></div>').css({overflow:"hidden",position:"relative"}).appendTo(r).append(r.container);r.cloneCount=0;r.cloneOffset=0}r.cloneCount=2;r.cloneOffset=1;t!=="init"&&r.container.find(".clone").remove();r.container.append(r.slides.first().clone().addClass("clone").attr("aria-hidden","true")).prepend(r.slides.last().clone().addClass("clone").attr("aria-hidden","true"));r.newSlides=e(r.vars.selector,r);n=r.currentSlide+r.cloneOffset;r.container.width((r.count+r.cloneCount)*200+"%");r.setProps(n*r.computedW,"init");setTimeout(function(){r.doMath();r.newSlides.css({width:r.computedW,"float":"left",display:"block"});f.smoothHeight()},t==="init"?100:0);r.slides.removeClass(l+"active-slide").eq(r.currentSlide).addClass(l+"active-slide")};r.doMath=function(){var e=r.slides.first();r.w=r.viewport===undefined?r.width():r.viewport.width();r.h=e.height();r.boxPadding=e.outerWidth()-e.width();r.itemW=r.w;r.pagingCount=r.count;r.last=r.count-1;r.computedW=r.itemW-r.boxPadding};r.update=function(e,t){r.doMath();e<r.currentSlide?r.currentSlide+=1:e<=r.currentSlide&&e!==0&&(r.currentSlide-=1);r.animatingTo=r.currentSlide;if(t==="add"||r.pagingCount>r.controlNav.length)f.controlNav.update("add");else if(t==="remove"||r.pagingCount<r.controlNav.length){if(r.currentSlide>r.last){r.currentSlide-=1;r.animatingTo-=1}f.controlNav.update("remove",r.last)}f.directionNav.update()};f.init()};e.featuredslider.defaults={namespace:"slider-",selector:".slides > li",animationSpeed:600,controlsContainer:"",prevText:featuredSliderDefaults.prevText,nextText:featuredSliderDefaults.nextText};e.fn.featuredslider=function(t){t===undefined&&(t={});if(typeof t=="object")return this.each(function(){var n=e(this),r=t.selector?t.selector:".slides > li",i=n.find(r);i.length===1||i.length===0?i.fadeIn(400):n.data("featuredslider")===undefined&&new e.featuredslider(this,t)})}})(jQuery);